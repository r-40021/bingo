var max=75,myHistory=[],select=[],colorList=["#ffa500","#d3e15c","#b384c7","#F06060","#a9ceec"],old=new Object;let anime,themeStatus;old.max=[],old.number=[],old.color=[];const isDark=window.matchMedia("(prefers-color-scheme: dark)");var loadingTimeout,checkedTimeout;document.addEventListener("DOMContentLoaded",(function(){loadingTimeout=setTimeout(()=>{document.getElementById("fixed").classList.add("loaded"),document.getElementById("loading").classList.add("loaded")},1e4)})),document.addEventListener("DOMContentLoaded",(function(){window.addEventListener("load",()=>{clearTimeout(loadingTimeout),document.getElementById("fixed").classList.add("loaded"),document.getElementById("loading").classList.add("loaded")})})),document.addEventListener("DOMContentLoaded",(function(){if(storageAvailable("localStorage")||alert("お使いの環境では、保存機能はご利用になれません。"),-1!==window.navigator.userAgent.toLowerCase().indexOf("android")){var elements=document.getElementsByClassName("shareIcon");for(let i=0;i<elements.length;i++)elements[i].classList.replace("bi-box-arrow-up","bi-share")}if(flex(),resize(),"dark"===localStorage.getItem("theme")?toggleTheme("d"):"light"===localStorage.getItem("theme")?toggleTheme("l"):"auto"===localStorage.getItem("theme")?toggleTheme("a"):toggleTheme(isDark),localStorage.getItem("myHistory")&&JSON.parse(localStorage.getItem("myHistory")).length>=1){var his=localStorage.getItem("myHistory");myHistory=JSON.parse(his);var historyBody=document.getElementById("history-body");for(let i=0;i<myHistory.length;i++){var div=document.createElement("div");div.className="history-number",div.innerHTML=myHistory[i],historyBody.appendChild(div)}document.getElementById("number-inner").innerHTML=myHistory[myHistory.length-1],old.number.unshift(Number(myHistory[myHistory.length-1])),historyBody.scroll(0,historyBody.scrollHeight-historyBody.clientHeight)}localStorage.getItem("max")&&(max=Number(localStorage.getItem("max")),document.getElementById("bingoMax").value=max,document.getElementById("bingoMaxText").value=max,old.max.unshift(Number(max))),localStorage.getItem("lastColor")&&(document.getElementById("bingoNumber").style.borderColor=colorList[Number(localStorage.getItem("lastColor"))],old.color.unshift(Number(localStorage.getItem("lastColor")))),addSelect(),getHistoryLength(),removeDisableSet()})),window.addEventListener("resize",(function(){flex(),resize()})),document.addEventListener("DOMContentLoaded",(function(){var range=document.getElementById("bingoMax"),rangeText=document.getElementById("bingoMaxText");range.addEventListener("input",(function(){rangeText.value=range.value,max=Number(range.value),old.max[0]=max,addSelect()})),rangeText.addEventListener("input",(function(){range.value=rangeText.value,max=Number(range.value),old.max[0]=max,addSelect()})),rangeText.addEventListener("change",(function(){rangeText.value<1&&(rangeText.value=1),rangeText.value>99&&(rangeText.value=99),range.value=rangeText.value,max=Number(range.value),old.max[0]=max,addSelect()}))}));try{isDark.addEventListener("change",toggleTheme)}catch(e1){try{isDark.addListener(toggleTheme)}catch(e2){console.error(e2)}}function spin(){if(select.length<=0){var endModal;new bootstrap.Modal(document.getElementById("end-modal")).show()}else{makeDisableSet();var undoElement=document.getElementById("undo");undoElement.style.visibility="hidden",document.getElementById("startOver").style.visibility="hidden";var count=0,numberElement=document.getElementById("bingoNumber");if(1===select.length)var stop=5;else var stop=Math.floor(7*Math.random()+5);var historyBody=document.getElementById("history-body"),spin=setInterval(()=>{var index=Math.floor(Math.random()*select.length),display=select[index];document.getElementById("number-inner").innerHTML=display;var colorIndex=count%colorList.length;if(numberElement.style.borderColor=colorList[colorIndex],++count>=stop){clearInterval(spin);var div=document.createElement("div");div.className="history-number",div.innerHTML=display,myHistory.push(display),localStorage.setItem("myHistory",JSON.stringify(myHistory)),localStorage.setItem("lastColor",colorIndex),select.splice(select.indexOf(display),1),historyBody.appendChild(div),old.max.unshift(Number(max)),old.number.unshift(Number(display)),old.color.unshift(Number(colorIndex)),old.number.length>=2&&old.max.length>=2&&old.color.length>=2&&(undoElement.style.visibility="visible"),historyBody.scroll(0,historyBody.scrollHeight-historyBody.clientHeight),getHistoryLength(),removeDisableSet()}},300)}}function resize(){var numberElement=document.getElementById("bingoNumber"),wrapElement=document.getElementById("number-wrap"),historyElement=document.getElementById("history-body");wrapElement.clientHeight>=wrapElement.clientWidth?(numberElement.style.width="90%",numberElement.style.height=numberElement.offsetWidth+"px"):(numberElement.style.height="90%",numberElement.style.width=numberElement.offsetHeight+"px"),numberElement.style.fontSize=numberElement.offsetHeight/5*3+"px",numberElement.style.borderWidth=.1*numberElement.offsetHeight+"px",window.innerWidth<=576?historyElement.style.fontSize=.12*historyElement.clientWidth/3*2+"px":historyElement.style.fontSize=.09*historyElement.clientWidth/3*2+"px",document.getElementById("privacy-iframe-wrap").style.width=document.getElementById("privacyModalBody").clientWidth-40+"px",document.getElementById("privacy-iframe-wrap").style.height=document.getElementById("privacyModalBody").clientHeight-40+"px"}function addSelect(){select=[],localStorage.setItem("max",max);for(let i=0;i<max;i++)-1===myHistory.indexOf(i+1)&&-1===select.indexOf(i+1)&&select.push(i+1)}function makeDisable(element){document.getElementById(element).setAttribute("disabled",null)}function makeDisableSet(){makeDisable("spin"),makeDisable("reset"),makeDisable("bingoMax"),makeDisable("bingoMaxText")}function removeDisable(element){document.getElementById(element).removeAttribute("disabled")}function removeDisableSet(){removeDisable("spin"),removeDisable("reset"),removeDisable("bingoMax"),removeDisable("bingoMaxText"),document.getElementById("spin").focus()}function resetAsk(){new bootstrap.Modal(document.getElementById("reset-modal")).show()}function reset(){document.getElementById("undo").style.visibility="hidden",document.getElementById("startOver").style.visibility="hidden",makeDisableSet(),localStorage.removeItem("myHistory"),localStorage.removeItem("lastColor"),document.getElementById("number-inner").innerHTML=null,document.getElementById("history-body").innerHTML=null,document.getElementById("bingoNumber").style.borderColor=colorList[0],myHistory=[],select=[],(old=new Object).max=[],old.number=[],old.color=[],addSelect(),getHistoryLength(),removeDisableSet()}function storageAvailable(type){var storage;try{storage=window[type];var x="__storage_test__";return storage.setItem(x,x),storage.removeItem(x),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&storage&&0!==storage.length}}function flex(){var height=window.innerHeight;document.getElementsByClassName("fixed")[0].style.height=height+"px",document.body.style.height=height+"px"}function copy(){clearTimeout(checkedTimeout);var url=location.href;navigator.clipboard.writeText(url),document.getElementById("checked-icon").style.display="inline",document.getElementById("url-icon").style.display="none",checkedTimeout=setTimeout(()=>{document.getElementById("checked-icon").style.display="none",document.getElementById("url-icon").style.display="inline"},1e4)}function undo(){var numberElements=document.getElementsByClassName("history-number"),removeNumber=numberElements[numberElements.length-1];removeNumber.remove(),myHistory.splice(myHistory.indexOf(removeNumber.innerHTML),1),document.getElementById("number-inner").innerHTML=old.number[1],document.getElementById("bingoNumber").style.borderColor=colorList[old.color[1]],max=old.max[1],document.getElementById("bingoMax").value=max,document.getElementById("bingoMaxText").value=max,addSelect(),localStorage.setItem("myHistory",JSON.stringify(myHistory)),localStorage.setItem("max",old.max[1]),localStorage.setItem("lastColor",old.color[1]),document.getElementById("undo").style.visibility="hidden",document.getElementById("startOver").style.visibility="visible",getHistoryLength(),document.getElementById("spin").focus()}function startOver(){var historyBody=document.getElementById("history-body"),div=document.createElement("div"),oldNumber=old.number[0];div.className="history-number",div.innerHTML=oldNumber,historyBody.appendChild(div),document.getElementById("number-inner").innerHTML=oldNumber,document.getElementById("bingoNumber").style.borderColor=colorList[old.color[0]],max=old.max[0],document.getElementById("bingoMax").value=max,document.getElementById("bingoMaxText").value=max,myHistory.push(oldNumber),addSelect(),localStorage.setItem("myHistory",JSON.stringify(myHistory)),localStorage.setItem("max",old.max[0]),localStorage.setItem("lastColor",old.color[0]),document.getElementById("undo").style.visibility="visible",document.getElementById("startOver").style.visibility="hidden",getHistoryLength(),document.getElementById("spin").focus()}function getHistoryLength(){document.getElementById("historyLength").innerText=myHistory.length}function openPage(url){window.open(url)}function toggleTheme(mql){clearInterval(anime),document.body.classList.add("anime");let auto=document.getElementById("auto"),light=document.getElementById("light"),dark=document.getElementById("dark");function changeIcon(type){let elementsList=document.getElementsByClassName("themeIcon"),classList=["bi-sun","bi-moon-fill"];if("dark"===type)for(let i=0;i<elementsList.length;i++){const element=elementsList[i];element.classList.replace(classList[0],classList[1])}else for(let i=0;i<elementsList.length;i++){const element=elementsList[i];element.classList.replace(classList[1],classList[0])}}themeStatus?"d"===mql?(document.body.classList.add("dark"),changeIcon("dark"),noActive(),dark.classList.add("active"),localStorage.setItem("theme","dark")):"l"===mql?(document.body.classList.remove("dark"),changeIcon("light"),noActive(),light.classList.add("active"),localStorage.setItem("theme","light")):"a"===mql&&(isDark.matches?(document.body.classList.add("dark"),changeIcon("dark"),localStorage.setItem("theme","auto")):(document.body.classList.remove("dark"),changeIcon("light"),localStorage.setItem("theme","auto")),noActive(),auto.classList.add("active")):!isDark.matches&&"d"!==mql||"l"===mql?(document.body.classList.remove("dark"),changeIcon("light"),"l"===mql?(noActive(),light.classList.add("active"),localStorage.setItem("theme","light")):localStorage.setItem("theme","auto")):(document.body.classList.add("dark"),changeIcon("dark"),"d"===mql?(noActive(),dark.classList.add("active"),localStorage.setItem("theme","dark")):localStorage.setItem("theme","auto")),"d"===mql||"l"===mql?themeStatus=1:"a"===mql&&(themeStatus=0),anime=setInterval(()=>{document.body.classList.remove("anime")},1e3)}function noActive(){let list;document.querySelectorAll("#theme .list-group-item").forEach((function(element){element.classList.remove("active")}))}"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("sw.js").then((function(registration){console.log("ServiceWorker registration successful with scope: ",registration.scope)}),(function(err){console.log("ServiceWorker registration failed: ",err)}))})),document.getElementById("privacy").addEventListener("shown.bs.modal",()=>{let iframeElement;document.getElementById("privacy-iframe").contentWindow.location.href="https://r-40021.github.io/privacy.html",resize()});